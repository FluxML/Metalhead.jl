<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Contributing to Metalhead · Metalhead.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://fluxml.ai/Metalhead.jl/stable/contributing/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Metalhead.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/quickstart/">A guide to getting started with Metalhead</a></li><li><a class="tocitem" href="../tutorials/pretrained/">Working with pre-trained models from Metalhead</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Convolutional Neural Networks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/others/">Other models</a></li><li><a class="tocitem" href="../api/inception/">Inception models</a></li><li><a class="tocitem" href="../api/resnet/">ResNet-like models</a></li><li><a class="tocitem" href="../api/densenet/">DenseNet</a></li><li><a class="tocitem" href="../api/hybrid/">Hybrid CNN architectures</a></li><li><a class="tocitem" href="../api/layers/">Layers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Mixers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/mixers/">MLPMixer-like models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Vision Transformers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/vit/">Vision Transformer models</a></li></ul></li><li><a class="tocitem" href="../api/utilities/">Utilities</a></li></ul></li><li><span class="tocitem">How To</span><ul><li><a class="tocitem" href="../howto/resnet/">Using the ResNet model family in Metalhead.jl</a></li></ul></li><li class="is-active"><a class="tocitem" href>Contributing to Metalhead</a><ul class="internal"><li><a class="tocitem" href="#Fixing-bugs"><span>Fixing bugs</span></a></li><li><a class="tocitem" href="#Adding-models"><span>Adding models</span></a></li><li><a class="tocitem" href="#Adding-pre-trained-weights"><span>Adding pre-trained weights</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Contributing to Metalhead</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Contributing to Metalhead</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FluxML/Metalhead.jl/blob/master/docs/src/contributing.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="contributing"><a class="docs-heading-anchor" href="#contributing">Contribute to Metalhead.jl</a><a id="contributing-1"></a><a class="docs-heading-anchor-permalink" href="#contributing" title="Permalink"></a></h1><p>We welcome contributions from anyone to Metalhead.jl! Thank you for taking the time to make our ecosystem better.</p><p>You can contribute by fixing bugs, adding new models, or adding pre-trained weights. If you aren&#39;t ready to write some code, but you think you found a bug or have a feature request, please <a href="https://github.com/FluxML/Metalhead.jl/issues/new/choose">post an issue</a>.</p><p>Before continuing, make sure you read the <a href="https://github.com/FluxML/Flux.jl/blob/master/CONTRIBUTING.md">FluxML contributing guide</a> for general guidelines and tips.</p><h2 id="Fixing-bugs"><a class="docs-heading-anchor" href="#Fixing-bugs">Fixing bugs</a><a id="Fixing-bugs-1"></a><a class="docs-heading-anchor-permalink" href="#Fixing-bugs" title="Permalink"></a></h2><p>To fix a bug in Metalhead.jl, you can <a href="https://github.com/FluxML/Metalhead.jl/pulls">open a PR</a>. It would be helpful to file an issue first so that we can confirm the bug.</p><h2 id="Adding-models"><a class="docs-heading-anchor" href="#Adding-models">Adding models</a><a id="Adding-models-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-models" title="Permalink"></a></h2><p>To add a new model architecture to Metalhead.jl, you can <a href="https://github.com/FluxML/Metalhead.jl/pulls">open a PR</a>. Keep in mind a few guiding principles for how this package is designed:</p><ul><li>reuse layers from Flux as much as possible (e.g. use <code>Parallel</code> before defining a <code>Bottleneck</code> struct)</li><li>adhere as closely as possible to a reference such as a published paper (i.e. the structure of your model should follow intuitively from the paper)</li><li>use generic functional builders (e.g. <a href="../api/resnet/#Metalhead.resnet"><code>Metalhead.resnet</code></a> is the underlying function that builds &quot;ResNet-like&quot; models)</li><li>use multiple dispatch to add convenience constructors that wrap your functional builder</li></ul><p>When in doubt, just open a PR! We are more than happy to help review your code to help it align with the rest of the library. After adding a model, you might consider adding some pre-trained weights (see below).</p><h2 id="Adding-pre-trained-weights"><a class="docs-heading-anchor" href="#Adding-pre-trained-weights">Adding pre-trained weights</a><a id="Adding-pre-trained-weights-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-pre-trained-weights" title="Permalink"></a></h2><p>To add pre-trained weights for an existing model or new model, you can <a href="https://github.com/FluxML/Metalhead.jl/pulls">open a PR</a>. Below, we describe the steps you should follow to get there.</p><p>All Metalhead.jl model artifacts are hosted using HuggingFace. You can find the FluxML account <a href="https://huggingface.co/FluxML">here</a>. This <a href="https://huggingface.co/docs/hub/models">documentation from HuggingFace</a> will provide you with an introduction to their ModelHub. In short, the Model Hub is a collection of Git repositories, similar to Julia packages on GitHub. This means you can <a href="https://huggingface.co/docs/hub/repositories-pull-requests-discussions">make a pull request to our HuggingFace repositories</a> to upload updated weight artifacts just like you would make a PR on GitHub to upload code.</p><ol><li>Train your model or port the weights from another framework.</li><li>Save the model using <a href="https://github.com/JuliaIO/BSON.jl">BSON.jl</a> with <code>BSON.@save &quot;modelname.bson&quot; model</code>. It is important that your model is saved under the key <code>model</code>. Note that due to the way this</li></ol><p>process works, to maintain compatibility with different Julia versions, the model must be saved using the LTS version of Julia (currently 1.6).</p><ol><li>Compress the saved model as a tarball using <code>tar -cvzf modelname.tar.gz modelname.bson</code>.</li><li>Obtain the SHAs (see the <a href="https://pkgdocs.julialang.org/v1/artifacts/#Basic-Usage">Pkg docs</a>). Edit the <code>Artifacts.toml</code> file in the Metalhead.jl repository and add entry for your model. You can leave the URL empty for now.</li><li>Open a PR on Metalhead.jl. Be sure to ping a maintainer (e.g. <code>@darsnack</code> or <code>@theabhirath</code>) to let us know that you are adding a pre-trained weight. We will create a model repository on HuggingFace if it does not already exist.</li><li>Open a PR to the <a href="https://huggingface.co/FluxML">corresponding HuggingFace repo</a>. Do this by going to the &quot;Community&quot; tab in the HuggingFace repository. PRs and discussions are shown as the same thing in the HuggingFace web app. You can use your local Git program to make clone the repo and make PRs if you wish. Check out the <a href="https://huggingface.co/docs/hub/repositories-pull-requests-discussions">guide on PRs to HuggingFace</a> for more information.</li><li>Copy the download URL for the model file that you added to HuggingFace. Make sure to grab the URL for a specific commit and not for the <code>main</code> branch.</li><li>Update your Metalhead.jl PR by adding the URL to the Artifacts.toml.</li><li>If the tests pass for your weights, we will merge your PR! Your model should pass the <code>acctest</code> function in the Metalhead.jl test suite. If your model already exists in the repo, then these tests are already in place, and you can add your model configuration to the <code>PRETRAINED_MODELS</code> list in the <code>runtests.jl</code> file. Please refer to the ResNet tests as an example.</li></ol><p>If you want to fix existing weights, then you can follow the same set of steps.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../howto/resnet/">« Using the ResNet model family in Metalhead.jl</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 17 September 2022 13:43">Saturday 17 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
