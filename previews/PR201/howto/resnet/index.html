<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Using the ResNet model family in Metalhead.jl · Metalhead.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://fluxml.ai/Metalhead.jl/stable/howto/resnet/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Metalhead.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/quickstart/">A guide to getting started with Metalhead</a></li><li><a class="tocitem" href="../../tutorials/pretrained/">Working with pre-trained models from Metalhead</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Convolutional Neural Networks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/others/">Other models</a></li><li><a class="tocitem" href="../../api/inception/">Inception models</a></li><li><a class="tocitem" href="../../api/resnet/">ResNet-like models</a></li><li><a class="tocitem" href="../../api/densenet/">DenseNet</a></li><li><a class="tocitem" href="../../api/hybrid/">Hybrid CNN architectures</a></li><li><a class="tocitem" href="../../api/layers/">Layers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Mixers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/mixers/">MLPMixer-like models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Vision Transformers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/vit/">Vision Transformer models</a></li></ul></li><li><a class="tocitem" href="../../api/utilities/">Utilities</a></li></ul></li><li><span class="tocitem">How To</span><ul><li class="is-active"><a class="tocitem" href>Using the ResNet model family in Metalhead.jl</a><ul class="internal"><li><a class="tocitem" href="#Pre-trained-models"><span>Pre-trained models</span></a></li><li><a class="tocitem" href="#More-configuration-options"><span>More configuration options</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributing to Metalhead</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How To</a></li><li class="is-active"><a href>Using the ResNet model family in Metalhead.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Using the ResNet model family in Metalhead.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FluxML/Metalhead.jl/blob/master/docs/src/howto/resnet.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-the-ResNet-model-family-in-Metalhead.jl"><a class="docs-heading-anchor" href="#Using-the-ResNet-model-family-in-Metalhead.jl">Using the ResNet model family in Metalhead.jl</a><a id="Using-the-ResNet-model-family-in-Metalhead.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-ResNet-model-family-in-Metalhead.jl" title="Permalink"></a></h1><p>ResNets are one of the most common convolutional neural network (CNN) models used today. Originally proposed by He et al. in <a href="https://arxiv.org/abs/1512.03385"><strong>Deep Residual Learning for Image Recognition</strong></a>, they use a residual structure to learn identity mappings that strengthens gradient propagation, thereby helping to prevent the vanishing gradient problem and allow the advent of truly deep neural networks as used today.</p><p>Many variants on the original ResNet structure have since become widely used such as <a href="https://arxiv.org/abs/1605.07146">Wide-ResNet</a>, <a href="https://arxiv.org/abs/1611.05431v2">ResNeXt</a>, <a href="https://arxiv.org/abs/1709.01507">SE-ResNet</a> and <a href="https://www.notion.so/ResNet-user-guide-b4c09e5bb5ae41328165a3f160a104f6">Res2Net</a>. Apart from suggesting modifications to the structure of the residual block, papers have also suggested modifying the stem of the network, adding newer regularisation options in the form of stochastic depth and DropBlock, and changing the downsampling path for the blocks to improve performance.</p><p>Metalhead provides an extensible, hackable yet powerful interface for working with ResNets that provides built-in toggles for commonly used options in papers and other deep learning libraries, while also allowing the user to build custom model structures if they want very easily.</p><h2 id="Pre-trained-models"><a class="docs-heading-anchor" href="#Pre-trained-models">Pre-trained models</a><a id="Pre-trained-models-1"></a><a class="docs-heading-anchor-permalink" href="#Pre-trained-models" title="Permalink"></a></h2><p>Metalhead provides a variety of pretrained models in the ResNet family to allow users to get started quickly with tasks like transfer learning. Pretrained models for <a href="../../api/resnet/#Metalhead.ResNet"><code>ResNet</code></a> with depth 18, 34, 50, 101 and 152 is supported, as is <a href="../../api/resnet/#Metalhead.WideResNet"><code>WideResNet</code></a> with depths 50 and 101. <a href="../../api/resnet/#Metalhead.ResNeXt"><code>ResNeXt</code></a> also supports some configurations of pretrained models - to know more, check out the documentation for the model.</p><p>This is as easy as setting the <code>pretrain</code> keyword to <code>true</code> when constructing the model. For example, to load a pretrained <code>ResNet</code> with depth 50, you can do the following:</p><pre><code class="language-julia hljs">using Metalhead

model = ResNet(50; pretrain=true)</code></pre><p>To check out more about using pretrained models, check out the <a href="../../tutorials/pretrained/#pretrained">pretrained models guide</a>.</p><h2 id="More-configuration-options"><a class="docs-heading-anchor" href="#More-configuration-options">More configuration options</a><a id="More-configuration-options-1"></a><a class="docs-heading-anchor-permalink" href="#More-configuration-options" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../api/utilities/">« Utilities</a><a class="docs-footer-nextpage" href="../../contributing/">Contributing to Metalhead »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 17 September 2022 13:43">Saturday 17 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
